{
  "openapi": "3.0.3",
  "info": {
    "title": "mysupply Public API",
    "description": "TODO: Write a description",
    "version": "0.1.0"
  },
  "servers": [
    {
      "url": "/v1"
    }
  ],
  "paths": {
    "/demands": {
      "post": {
        "summary": "Submit a new demand",
        "description": "",
        "tags": ["Demands"],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "fields": {
                    "description": "Arbitrary data of interest sent as JSON object",
                    "type": "object"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Demand was received",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "description": "The mysupply ID assigned to the demand",
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/demands/{id}": {
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "description": "The mysupply ID of the demand",
          "required": true,
          "allowEmptyValue": false,
          "schema": {
            "type": "string"
          }
        }
      ],
      "get": {
        "tags": ["Demands"],
        "summary": "Returns information for a specific demand",
        "responses": {
          "200": {
            "description": "Information for the demand",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "description": "The mysupply ID of a demand"
                    },
                    "workflowId": {
                      "type": "string",
                      "nullable": true,
                      "description": "The ID of the workflow to which the demand has been assigned. Null if the demand has not yet been assigned to a workflow."
                    },
                    "fields": {
                      "type": "object",
                      "description": "The fields data of the demand"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "A demand with such ID has not been found"
          }
        }
      }
    },
    "/workflow/{id}": {
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "description": "The mysupply ID of a workflow",
          "required": true,
          "allowEmptyValue": false,
          "schema": {
            "type": "string"
          }
        }
      ],
      "get": {
        "tags": ["Workflow"],
        "responses": {
          "404": {
            "description": "A workflow with this ID was not found"
          },
          "200": {
            "description": "Information for the workflow",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "description": "The mysupply ID of the worklfow"
                    },
                    "phase": {
                      "type": "string",
                      "description": "The current state of the workflow",
                      "enum": [
                        "setup",
                        "collecting offers",
                        "negotiations",
                        "finished"
                      ]
                    },
                    "requestFroProposals": {
                      "type": "object",
                      "properties": {
                        "requestItems": {
                          "type": "array",
                          "description": "An array of items sought to be procured with this request",
                          "items": {
                            "type": "object",
                            "properties": {
                              "title": {
                                "type": "string",
                                "description": "The title/name of the item",
                                "example": "Office chairs"
                              },
                              "amount": {
                                "type": "number",
                                "description": "The number/amount of the item sought to be procured",
                                "example": 20
                              },
                              "unitOfMeasure": {
                                "type": "string",
                                "description": "The unit in which the amount is measured",
                                "example": "piece"
                              },
                              "demandIds": {
                                "type": "array",
                                "description": "The IDs of the demands from which this request item has been derived from if any.",
                                "items": {
                                  "type": "string"
                                }
                              },
                              "customFields": {
                                "type": "object",
                                "description": "Custom fields with arbitrary data"
                              }
                            }
                          }
                        }
                      }
                    },
                    "invitedSuppliers": {
                      "type": "array",
                      "description": "The suppliers which have been invited to submit responses to the request",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "description": "A mysupply ID of the supplier for reference in the workflow"
                          },
                          "supplierNumber": {
                            "type": "string",
                            "description": "A client provided supplier number/identificator. Null if non is provided.",
                            "nullable": true
                          },
                          "inviteeEmail": {
                            "type": "string",
                            "description": "The email which was used to send the invitation to."
                          }
                        }
                      }
                    },
                    "responses": {
                      "type": "array",
                      "description": "The received responses to the request",
                      "items": {
                        "type": "object",
                        "properties": {
                          "supplierId": {
                            "type": "string",
                            "description": "The mysupply ID of the invited supplier who submitted this response"
                          },
                          "quotations": {
                            "type": "array",
                            "description": "Price quotations for the requested items which the supplier can deliver. A missing quotation for a request item indicates that the supplier is not able to deliver the requested item.",
                            "items": {
                              "type": "object",
                              "properties": {
                                "requestItemId": {
                                  "type": "string",
                                  "description": "The mysupply ID of the requested item"
                                },
                                "price": {
                                  "description": "The quotation price for the item",
                                  "type": "object",
                                  "properties": {
                                    "amount": {
                                      "type": "number",
                                      "description": "The value of the price in its currency.",
                                      "example": "17.05"
                                    },
                                    "currency": {
                                      "type": "string",
                                      "description": "The currency code for the price.",
                                      "example": "EUR"
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    },
                    "deals": {
                      "type": "array",
                      "description": "The deals made with suppliers after the end of the respective negotiations",
                      "items": {
                        "type": "object",
                        "properties": {
                          "dealId": {
                            "type": "string",
                            "description": "The mysupply ID of the deal"
                          },
                          "supplierId": {
                            "type": "string",
                            "description": "The mysupply ID of the invited supplier"
                          },
                          "totalPrice": {
                            "type": "object",
                            "description": "The negotiated total price for the items in this deal.",
                            "properties": {
                              "amount": {
                                "type": "number",
                                "description": "The value of the price in its currency.",
                                "example": "17.05"
                              },
                              "currency": {
                                "type": "string",
                                "description": "The currency code for the price.",
                                "example": "EUR"
                              }
                            }
                          },
                          "dealItems": {
                            "type": "array",
                            "description": "The request items for which are included in this deal along with their negotiated single unit prices.",
                            "items": {
                              "type": "object",
                              "properties": {
                                "requestItemId": {
                                  "type": "string",
                                  "description": "The mysuply ID of the requested item"
                                },
                                "singleUnitPrice": {
                                  "type": "object",
                                  "description": "The negotiated single unit price for the item.",
                                  "properties": {
                                    "amount": {
                                      "type": "number",
                                      "description": "The value of the price in its currency.",
                                      "example": "17.05"
                                    },
                                    "currency": {
                                      "type": "string",
                                      "description": "The currency code for the price.",
                                      "example": "EUR"
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
