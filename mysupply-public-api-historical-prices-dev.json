{
  "openapi": "3.0.3",
  "info": {
    "title": "mysupply Public API - Historical Prices (Under Development)",
    "version": "0.1.0-dev",
    "description": "Historical Prices endpoints currently under development for the mysupply Public API"
  },
  "servers": [
    {
      "url": "/v1"
    }
  ],
  "security": [
    {
      "BearerAuth": []
    }
  ],
  "paths": {
    "/historical-prices": {
      "get": {
        "summary": "Fetch a paginated list of historical prices",
        "tags": ["Historical Prices"],
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 1
            },
            "description": "The number of the page to fetch starting at 1"
          },
          {
            "name": "organizationId",
            "in": "query",
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Filter by organization ID"
          },
          {
            "name": "materialNumber",
            "in": "query",
            "schema": {
              "type": "string"
            },
            "description": "Filter by material number"
          },
          {
            "name": "materialGroup",
            "in": "query",
            "schema": {
              "type": "string"
            },
            "description": "Filter by material group"
          },
          {
            "name": "supplierNumber",
            "in": "query",
            "schema": {
              "type": "string"
            },
            "description": "Filter by supplier number"
          },
          {
            "name": "orderDateFrom",
            "in": "query",
            "schema": {
              "type": "string",
              "format": "date"
            },
            "description": "Filter by order date (from)"
          },
          {
            "name": "orderDateTo",
            "in": "query",
            "schema": {
              "type": "string",
              "format": "date"
            },
            "description": "Filter by order date (to)"
          }
        ],
        "responses": {
          "200": {
            "description": "A list of historical prices",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/historicalPrice"
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          }
        }
      },
      "post": {
        "summary": "Create a new historical price record",
        "tags": ["Historical Prices"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/newHistoricalPrice"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Historical price record was created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/historicalPrice"
                }
              }
            }
          },
          "400": {
            "description": "Invalid input"
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "422": {
            "description": "Unprocessable entity"
          }
        }
      }
    },
    "/historical-prices/clear": {
      "post": {
        "summary": "Clear all historical prices for an organization",
        "tags": ["Historical Prices"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["organizationId"],
                "properties": {
                  "organizationId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Organization ID"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "204": {
            "description": "Historical prices successfully cleared"
          },
          "400": {
            "description": "Invalid input"
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          }
        }
      }
    },
    "/historical-prices/{id}": {
      "parameters": [
        {
          "$ref": "#/components/parameters/historicalPriceId"
        }
      ],
      "get": {
        "summary": "Returns information for a specific historical price",
        "tags": ["Historical Prices"],
        "responses": {
          "200": {
            "description": "Information for the historical price",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/historicalPrice"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "404": {
            "description": "A historical price with such ID has not been found"
          }
        }
      },
      "patch": {
        "summary": "Update a specific historical price",
        "tags": ["Historical Prices"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/updateHistoricalPrice"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Historical price was updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/historicalPrice"
                }
              }
            }
          },
          "400": {
            "description": "Invalid input"
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "404": {
            "description": "A historical price with such ID has not been found"
          },
          "422": {
            "description": "Unprocessable entity"
          }
        }
      },
      "delete": {
        "summary": "Delete a specific historical price",
        "tags": ["Historical Prices"],
        "responses": {
          "204": {
            "description": "Historical price successfully deleted"
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "404": {
            "description": "A historical price with such ID has not been found"
          }
        }
      }
    }
  },
  "components": {
    "securitySchemes": {
      "BearerAuth": {
        "type": "http",
        "scheme": "bearer"
      }
    },
    "responses": {
      "UnauthorizedError": {
        "description": "Access token is missing or invalid"
      }
    },
    "parameters": {
      "historicalPriceId": {
        "name": "id",
        "in": "path",
        "description": "The mysupply ID of the historical price",
        "required": true,
        "allowEmptyValue": false,
        "schema": {
          "type": "string",
          "format": "uuid"
        },
        "example": "83da61b6-e11e-495d-9808-3e1ff7869c19"
      }
    },
    "schemas": {
      "historicalPrice": {
        "type": "object",
        "description": "A historical price record for purchased materials",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "The mysupply ID of the historical price",
            "example": "83da61b6-e11e-495d-9808-3e1ff7869c19"
          },
          "organizationId": {
            "type": "string",
            "format": "uuid",
            "description": "Organization ID",
            "example": "a1b2c3d4-e5f6-7890-abcd-ef1234567890"
          },
          "productOrderNumber": {
            "type": "string",
            "description": "Product order number",
            "example": "PO-2024-001234"
          },
          "materialNumber": {
            "type": "string",
            "description": "Material number from ERP system",
            "example": "MAT-789456"
          },
          "materialGroup": {
            "type": "string",
            "description": "Material group classification",
            "example": "MG-ELECTRONICS"
          },
          "materialNumberDescription": {
            "type": "string",
            "nullable": true,
            "description": "Description of the material number",
            "example": "High-performance microprocessor unit"
          },
          "materialGroupDescription": {
            "type": "string",
            "nullable": true,
            "description": "Description of the material group",
            "example": "Electronic components and semiconductors"
          },
          "demandTitle": {
            "type": "string",
            "description": "Title of the demand/requisition",
            "example": "Office Electronics Q1 2024"
          },
          "demandDescription": {
            "type": "string",
            "nullable": true,
            "description": "Detailed description of the demand",
            "example": "Procurement of electronic components for office equipment upgrade"
          },
          "demandQuantity": {
            "type": "string",
            "nullable": true,
            "description": "Quantity ordered",
            "example": "50"
          },
          "price": {
            "$ref": "#/components/schemas/price"
          },
          "supplierNumber": {
            "type": "string",
            "description": "Supplier number from ERP system",
            "example": "SUP-456789"
          },
          "orderDate": {
            "type": "string",
            "format": "date-time",
            "description": "Date when the order was placed",
            "example": "2024-01-15T10:30:00Z"
          },
          "importId": {
            "type": "string",
            "format": "uuid",
            "nullable": true,
            "description": "ID of the import batch this record belongs to",
            "example": "b2c3d4e5-f6a7-8901-bcde-f12345678901"
          },
          "importDate": {
            "type": "string",
            "format": "date-time",
            "nullable": true,
            "description": "Date when this record was imported",
            "example": "2024-01-20T14:45:00Z"
          }
        }
      },
      "newHistoricalPrice": {
        "type": "object",
        "description": "Data required to create a new historical price record",
        "required": [
          "organizationId",
          "productOrderNumber",
          "materialNumber",
          "materialGroup",
          "demandTitle",
          "price",
          "supplierNumber",
          "orderDate"
        ],
        "properties": {
          "organizationId": {
            "type": "string",
            "format": "uuid",
            "description": "Organization ID"
          },
          "productOrderNumber": {
            "type": "string",
            "description": "Product order number",
            "example": "PO-2024-001234"
          },
          "materialNumber": {
            "type": "string",
            "description": "Material number from ERP system",
            "example": "MAT-789456"
          },
          "materialGroup": {
            "type": "string",
            "description": "Material group classification",
            "example": "MG-ELECTRONICS"
          },
          "materialNumberDescription": {
            "type": "string",
            "nullable": true,
            "description": "Description of the material number",
            "example": "High-performance microprocessor unit"
          },
          "materialGroupDescription": {
            "type": "string",
            "nullable": true,
            "description": "Description of the material group",
            "example": "Electronic components and semiconductors"
          },
          "demandTitle": {
            "type": "string",
            "description": "Title of the demand/requisition",
            "example": "Office Electronics Q1 2024"
          },
          "demandDescription": {
            "type": "string",
            "nullable": true,
            "description": "Detailed description of the demand",
            "example": "Procurement of electronic components for office equipment upgrade"
          },
          "demandQuantity": {
            "type": "string",
            "nullable": true,
            "description": "Quantity ordered",
            "example": "50"
          },
          "price": {
            "$ref": "#/components/schemas/price"
          },
          "supplierNumber": {
            "type": "string",
            "description": "Supplier number from ERP system",
            "example": "SUP-456789"
          },
          "orderDate": {
            "type": "string",
            "format": "date-time",
            "description": "Date when the order was placed",
            "example": "2024-01-15T10:30:00Z"
          },
          "importId": {
            "type": "string",
            "format": "uuid",
            "nullable": true,
            "description": "ID of the import batch this record belongs to"
          }
        }
      },
      "updateHistoricalPrice": {
        "type": "object",
        "description": "Data for updating an existing historical price record",
        "properties": {
          "productOrderNumber": {
            "type": "string",
            "description": "Product order number"
          },
          "materialNumber": {
            "type": "string",
            "description": "Material number from ERP system"
          },
          "materialGroup": {
            "type": "string",
            "description": "Material group classification"
          },
          "materialNumberDescription": {
            "type": "string",
            "nullable": true,
            "description": "Description of the material number"
          },
          "materialGroupDescription": {
            "type": "string",
            "nullable": true,
            "description": "Description of the material group"
          },
          "demandTitle": {
            "type": "string",
            "description": "Title of the demand/requisition"
          },
          "demandDescription": {
            "type": "string",
            "nullable": true,
            "description": "Detailed description of the demand"
          },
          "demandQuantity": {
            "type": "string",
            "nullable": true,
            "description": "Quantity ordered"
          },
          "price": {
            "$ref": "#/components/schemas/price"
          },
          "supplierNumber": {
            "type": "string",
            "description": "Supplier number from ERP system"
          },
          "orderDate": {
            "type": "string",
            "format": "date-time",
            "description": "Date when the order was placed"
          }
        }
      },
      "price": {
        "type": "object",
        "description": "A monetary value (unit price)",
        "required": ["amount", "currency"],
        "properties": {
          "amount": {
            "type": "string",
            "format": "{1,9}+(\\.\\d+)?",
            "description": "A decimal string representation of the price amount with fixed precision",
            "example": "17.05"
          },
          "currency": {
            "type": "string",
            "description": "The currency code of the monetary value (ISO 4217)",
            "example": "EUR",
            "minLength": 3,
            "maxLength": 3
          }
        }
      }
    }
  }
}
